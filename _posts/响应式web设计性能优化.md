title: 如何对响应式web网站进行性能优化
---
### 现状
##### 手机版比桌面版慢吗？
为什么我们总是觉得响应式网站的加载速度很慢？有统计表明，30%的网站手机版的荷载要高于桌面版。

大多时候的原因是，手机端在渲染的时候不仅加载了桌面端的全部资源文件，还加载了额外的CSS与sprite文件，也就意味着手机端将比桌面端多出一些http请求，下载量也会略微大一些。

其实有不少大的网站采用的是将手机版站点和桌面版分开，也就是使用‘m.’的手机版专属网站。 这些站点会专门对手机端进行优化。

##### 为什么会这样？
很多响应式网站都存在一些同样的问题，这些问题导致手机版的网站较桌面端更慢。

1. 为所有的设备加载相同的资源

    一些站点会为所有设备加载所有的资源，然后通过媒体查询来调整体验，这样的做法的后果会在HTTP拥堵时暴露无疑。

2. 加载额外的资源

    这些额外的资源一般都是一些CSS和sprite文件，这种模式与我们熟知的移动体验完全违背了。

3. 加载双倍的图片

    最大的错误是，有的站点会为手机版本加载另外一组图片，这简直就是本末倒置。也许加载更大的图片再调整大小是为了让图片在小尺寸下显得更加清晰，但这样做的副作用很大，特别是如果你的网站拥有较多的图片的时候。

##### 这样做的反哲学
为什么这些网站会这样设计？这些问题都包含了一些相同的哲学思想：
- 它们明显都是着眼于桌面版本，并以此作为基础，在其上修改或新增元素，而不是从最小版本向上开发。
- 它们都没有利用各个平台的优势，也没有意识到各个平台的限制。
- 它们都试图仅从客户端来解决问题。

### 如何解决
那么对于响应式网站，我们应该采用哪些设计模式呢？

##### 加载适合相应设备的资源
对不同的设备我们应该准备合适的图片，可以从清晰度和带宽方面来考虑，比如对桌面端提供更大更清晰的图片。

##### 从后端提供专有的体验
一些提供独立的“m.”站点，还有一些网站展示的是从服务器端传输过来的基于设备独有布局的功能和页面。这种解决方案我们称之为RESS（响应式设计+服务端组件）。

##### 前端延迟加载的专有体验
有的站点不仅对图片进行延迟加载，而且对整个内容模块也进行延迟加载，包括上方和下方的折叠部分，通过这种方式，可以有效的避免为每个断点加载内容，从而适应客户端性能，达到最佳体验。

### 我们为什么不使用“m.”站点
对于相应式网站，我想很多人都思考过，为什么不之间提供一个“m.”的站点来针对移动端来设计呢？事实上，很多较大的公司，依然在使用的“m.”站点为人们提供移动服务。响应式网站的出现也不过是在几年之前，那我们为什么要选择响应式网站而不是“m.”移动专版网站呢？

##### 资源开销
“m.”网站需要一个专门的团队来开发和维护。

##### 分散的代码
维护一个单独是网站意味着你需要维护一个单独的web app和单独的一份代码，如果没有个人的自觉性好流程上的保证，最终它会变得混乱不堪和杂乱无章。

##### 分段独立的URL
使用一个单独的“m.”网站也就意味着你需要创建和维护一个单独的URL，这和我们将一个资源作为一个统一的管理的整体思想相违背。

##### 毫无意义的重定向
使用一个完全独立的URL也就意味着客户端进入网站的时候需要进行重定向。额外增加一个重定向也就意味着增加了不必要的延迟体验。

响应式设计并不是一个有缺陷的方法论，只有在它被误用为一个附加的功能而非首要原则的时候，才会导致一种臃肿的，违反直觉的体验。

性能是响应式设计的一个重要的方面，作为交互的一个重要方面，需要慎重计划和设计。对于前端工程师来说，这个技能可以说是必不可少的。在以后的博客中我还会详细介绍关于响应式网站性能的有关信息，祝各位学习愉快。
